<div class="container w-full sm:w-22rem">
    <h2 class="mt-0 align-self-start">Register</h2>

    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="form-container">
        <div class="form-field">
            <div class="flex flex-row align-items-center gap-2">
                <i class="pi pi-user"></i>
                <label for="username">Username</label>
            </div>
            <input id="username" type="text" formControlName="username" pInputText />
            @if (isUsernameInvalid) {
                <small class="text-red-300">
                    The provided username can only contain alphanumeric characters, dots, dashes, and underscores
                </small>
            }
        </div>
        <div class="form-field">
            <div class="flex flex-row align-items-center gap-2">
                <i class="pi pi-envelope"></i>
                <label for="email">Email</label>
            </div>
            <input id="email" type="email" formControlName="email" pInputText />
            @if (isEmailInvalid) {
                <small class="text-red-300">The provided email is invalid</small>
            }
        </div>
        <div class="form-field">
            <div class="flex flex-row align-items-center gap-2">
                <i class="pi pi-lock"></i>
                <label for="password">Password</label>
            </div>
            <p-password
                inputId="password"
                name="password"
                class="p-fluid"
                formControlName="password"
                [toggleMask]="true"
                [feedback]="false">
            </p-password>
            @if (isPasswordWeak) {
                <small class="text-red-300">The provided password is too weak</small>
            } @else if (isPasswordInvalid) {
                <small class="text-red-300">The provided password contains invalid characters</small>
            }
            <ul class="pl-0 m-0 text-sm line-height-3">
                <li class="flex gap-2 align-items-center">
                    @if (isPasswordLowercase) {
                        <i class="pi pi-times text-sm text-gray-300"></i>
                        <p class="m-0 text-gray-300">At least one lowercase</p>
                    } @else {
                        <i class="pi pi-check text-sm text-green-300"></i>
                        <p class="m-0 text-green-300">At least one lowercase</p>
                    }
                </li>
                <li class="flex gap-2 align-items-center">
                    @if (isPasswordUppercase) {
                        <i class="pi pi-times text-sm text-gray-300"></i>
                        <p class="m-0 text-gray-300">At least one uppercase</p>
                    } @else {
                        <i class="pi pi-check text-sm text-green-300"></i>
                        <p class="m-0 text-green-300">At least one uppercase</p>
                    }
                </li>
                <li class="flex gap-2 align-items-center">
                    @if (isPasswordNumeric) {
                        <i class="pi pi-times text-sm text-gray-300"></i>
                        <p class="m-0 text-gray-300">At least one numeric</p>
                    } @else {
                        <i class="pi pi-check text-sm text-green-300"></i>
                        <p class="m-0 text-green-300">At least one numeric</p>
                    }
                </li>
                <li class="flex gap-2 align-items-center">
                    @if (isPasswordSpecial) {
                        <i class="pi pi-times text-sm text-gray-300"></i>
                        <p class="m-0 text-gray-300">At least one special character</p>
                    } @else {
                        <i class="pi pi-check text-sm text-green-300"></i>
                        <p class="m-0 text-green-300">At least one special character</p>
                    }
                </li>
                <li class="flex gap-2 align-items-center">
                    @if (isPasswordShort) {
                        <i class="pi pi-times text-sm text-gray-300"></i>
                        <p class="m-0 text-gray-300">Minimum 8 characters</p>
                    } @else {
                        <i class="pi pi-check text-sm text-green-300"></i>
                        <p class="m-0 text-green-300">Minimum 8 characters</p>
                    }
                </li>
            </ul>
        </div>
        <div class="form-field">
            <div class="flex flex-row align-items-center gap-2">
                <i class="pi pi-check-square"></i>
                <label for="confirmPassword">Confirm Password</label>
            </div>
            <p-password
                inputId="confirmPassword"
                name="confirmPassword"
                class="p-fluid"
                formControlName="confirmPassword"
                [toggleMask]="true"
                [feedback]="false" />
            @if (hasPasswordMismatch) {
                <small class="text-red-300">The provided passwords do not match!</small>
            }
        </div>
        <p-button
            type="submit"
            [label]="isProcessingRegistration ? '' : 'Register'"
            [loading]="isProcessingRegistration"
            [disabled]="!userForm.valid"
            styleClass="w-full justify-content-center" />
    </form>

    <p class="mt-4 mb-0">
        Already have an account?
        <a routerLink="../login" class="text-blue-500 no-underline">Log In</a>
    </p>

    <p-toast position="bottom-right" [breakpoints]="{ '920px': { width: '90%' } }" />
</div>
